Peer-Graded Final Project:

Imagine that you are a lead Linux developer at the top-tech company ABC International Inc. ABC currently suffers from a huge bottleneck: each day, interns must painstakingly access encrypted password files on core servers and back up any files that were updated within the last 24 hours. This process introduces human error, lowers security, and takes an unreasonable amount of work.

As one of ABC Inc.'s most trusted Linux developers, you have been tasked with creating a script called backup.sh which runs every day and automatically backs up any encrypted password files that have been updated in the past 24 hours.

Grading criteria
There are a total of 20 points to be earned for 17 tasks in this final project.
Your grade will be based on the following tasks within the hands-on lab:

[Tasks 1-13]: Upload screenshot of sections from the backup.sh script displaying the correct code (13 pts: 1 pt for each of the 13 tasks)
[Task 14]: Submit your completed backup.sh file (1 pt)
[Task 15]: Upload screenshot showing executable permissions (2 pts)
[Task 16]: Upload screenshot showing file named backup-[TIMESTAMP].tar.gz (2 pts)
[Task 17]: Upload screenshot showing crontab schedule of once every day (2 pts)


#!/bin/bash

# This checks if the number of arguments is correct
# If the number of arguments is incorrect ( $# != 2) print error message and exit
if [[ $# != 2 ]]
then
  echo "backup.sh target_directory_name destination_directory_name"
  exit
fi

# This checks if argument 1 and argument 2 are valid directory paths
if [[ ! -d $1 ]] || [[ ! -d $2 ]]
then
  echo "Invalid directory path provided"
  exit
fi

# [TASK 1]
targetDirectory=$1
destinationDirectory=$2

# [TASK 2]
echo "$targetDirectory"
echo "$destinationDirectory"

# [TASK 3]
currentTS=`date +%s`

# [TASK 4]
backupFileName="backup-$currentTS.tar.gz"

# We're going to:
  # 1: Go into the target directory
  # 2: Create the backup file
  # 3: Move the backup file to the destination directory

# To make things easier, we will define some useful variables...

# [TASK 5]
origAbsPath=`pwd`

# [TASK 6]
cd "$destinationDirectory" # <-
destDirAbsPath=`pwd`

# [TASK 7]
cd $origAbsPath # <-
cd "$targetDirectory" # <-

# [TASK 8]
yesterdayTS=$(($currentTS - 24 * 60 * 60))

declare -a toBackup

for file in $(ls) # [TASK 9]
do
  # [TASK 10]
  if ((`date -r $file +%s` > $yesterdayTS))
  then
    toBackup+=($file)
  fi
done

# [TASK 12]

tar -czvf $backupFileName ${toBackup[@]}

# [TASK 13]

mv $backupFileName $destDirAbsPath

# Congratulations! You completed the final project for this course!